import FormData from "form-data"
import Axios from "axios"

export async function analyzeXray(image) {
  // return await analyzeGradient(null)
  return await analyzeRandom(null)
  // return analyzeActual(image)
}

export async function rocCurve(setType) {
  return new Promise((res, rej) => {
    setTimeout(() => {
      const response = {
        "atelectasis": {
          "fpr": [
            0.0,
            0.052901023890784986,
            0.052901023890784986,
            0.05460750853242321,
            0.05460750853242321,
            0.05631399317406143,
            0.05631399317406143,
            0.05802047781569966,
            0.05802047781569966,
            0.059726962457337884,
            0.059726962457337884,
            0.06143344709897611,
            0.06143344709897611,
            0.06313993174061433,
            0.06313993174061433,
            0.06484641638225255,
            0.06484641638225255,
            0.06484641638225255,
            0.06825938566552901,
            0.06996587030716724,
            0.06996587030716724,
            0.06996587030716724,
            0.07337883959044368,
            0.08020477815699659,
            0.08873720136518772,
            0.09897610921501707,
            0.12116040955631399,
            1.0],
          "tpr": [
            0.0,
            0.078125,
            0.140625,
            0.140625,
            0.375,
            0.375,
            0.4375,
            0.4375,
            0.515625,
            0.515625,
            0.53125,
            0.53125,
            0.578125,
            0.578125,
            0.59375,
            0.59375,
            0.609375,
            0.640625,
            0.640625,
            0.640625,
            0.65625,
            0.703125,
            0.71875,
            0.71875,
            0.75,
            0.765625,
            0.78125,
            1.0],
          "auc": 0.8319912542662116,
        },
        "cardiomegaly": {
          "fpr": [
            0.0,
            0.05454545454545454,
            0.05454545454545454,
            0.05454545454545454,
            0.05619834710743802,
            0.05619834710743802,
            0.05785123966942149,
            0.05950413223140496,
            0.06115702479338843,
            1.0],
          "tpr": [
            0.0,
            0.15555555555555556,
            0.2,
            0.6222222222222222,
            0.6222222222222222,
            0.7555555555555555,
            0.7777777777777778,
            0.7777777777777778,
            0.8,
            1.0],
          "auc": 0.8540863177226813,
        },
        "consolidation": {
          "fpr": [
            0.0,
            0.05921052631578947,
            0.06085526315789474,
            0.06085526315789474,
            0.0625,
            0.0625,
            0.06414473684210527,
            0.06414473684210527,
            0.06907894736842106,
            0.06907894736842106,
            0.07730263157894737,
            0.07730263157894737,
            0.07894736842105263,
            0.07894736842105263,
            0.08223684210526316,
            0.08223684210526316,
            0.08388157894736842,
            0.08388157894736842,
            0.08717105263157894,
            0.08717105263157894,
            0.08881578947368421,
            0.09210526315789473,
            0.09375,
            0.09375,
            0.09703947368421052,
            0.09868421052631579,
            0.10197368421052631,
            0.1069078947368421,
            0.1069078947368421,
            0.11348684210526316,
            0.11348684210526316,
            0.11513157894736842,
            0.11677631578947369,
            0.12335526315789473,
            0.1299342105263158,
            0.1299342105263158,
            0.13651315789473684,
            0.14967105263157895,
            0.16282894736842105,
            0.16776315789473684,
            0.1825657894736842,
            0.21875,
            1.0],
          "tpr": [
            0.0,
            0.0,
            0.0,
            0.2619047619047619,
            0.2619047619047619,
            0.2857142857142857,
            0.2857142857142857,
            0.30952380952380953,
            0.30952380952380953,
            0.3333333333333333,
            0.3333333333333333,
            0.38095238095238093,
            0.38095238095238093,
            0.40476190476190477,
            0.40476190476190477,
            0.42857142857142855,
            0.42857142857142855,
            0.47619047619047616,
            0.47619047619047616,
            0.5,
            0.5,
            0.5,
            0.5,
            0.5238095238095238,
            0.5238095238095238,
            0.5238095238095238,
            0.5238095238095238,
            0.5238095238095238,
            0.5476190476190477,
            0.5476190476190477,
            0.5714285714285714,
            0.5714285714285714,
            0.5952380952380952,
            0.5952380952380952,
            0.5952380952380952,
            0.6428571428571429,
            0.6904761904761905,
            0.7142857142857143,
            0.7619047619047619,
            0.8095238095238095,
            0.8095238095238095,
            0.8333333333333334,
            1.0],
          "auc": 0.8179824561403509,
        },
        "edema": {
          "fpr": [
            0.0,
            0.04745762711864407,
            0.04745762711864407,
            0.04915254237288136,
            0.04915254237288136,
            0.05084745762711865,
            0.05084745762711865,
            0.05254237288135593,
            0.05254237288135593,
            0.0576271186440678,
            0.0576271186440678,
            0.059322033898305086,
            0.059322033898305086,
            0.061016949152542375,
            0.061016949152542375,
            0.07288135593220339,
            0.07288135593220339,
            0.07288135593220339,
            0.07966101694915254,
            0.07966101694915254,
            0.08305084745762711,
            0.08813559322033898,
            0.10677966101694915,
            1.0],
          "tpr": [
            0.0,
            0.15,
            0.2833333333333333,
            0.2833333333333333,
            0.38333333333333336,
            0.38333333333333336,
            0.6,
            0.6,
            0.6333333333333333,
            0.6333333333333333,
            0.65,
            0.65,
            0.6666666666666666,
            0.6666666666666666,
            0.6833333333333333,
            0.6833333333333333,
            0.7,
            0.7333333333333333,
            0.7333333333333333,
            0.75,
            0.75,
            0.7666666666666667,
            0.8,
            1.0],
          "auc": 0.8491384180790961,
        },
        "effusion": {
          "fpr": [
            0.0,
            0.05396290050590219,
            0.05396290050590219,
            0.05564924114671164,
            0.05564924114671164,
            0.05564924114671164,
            0.05564924114671164,
            0.05733558178752108,
            0.05733558178752108,
            0.05733558178752108,
            0.05733558178752108,
            0.05733558178752108,
            0.06408094435075885,
            1.0],
          "tpr": [
            0.0,
            0.07017543859649122,
            0.15789473684210525,
            0.15789473684210525,
            0.2982456140350877,
            0.3333333333333333,
            0.38596491228070173,
            0.38596491228070173,
            0.40350877192982454,
            0.43859649122807015,
            0.45614035087719296,
            0.49122807017543857,
            0.5614035087719298,
            1.0],
          "auc": 0.7370344072660572,
        },
        "emphysema": {
          "fpr": [
            0.0,
            0.05564648117839607,
            0.05564648117839607,
            0.057283142389525366,
            0.057283142389525366,
            0.058919803600654665,
            0.058919803600654665,
            0.060556464811783964,
            0.060556464811783964,
            0.06382978723404255,
            0.06382978723404255,
            0.06873977086743044,
            0.06873977086743044,
            0.07037643207855974,
            0.07037643207855974,
            0.07364975450081833,
            0.07364975450081833,
            0.08183306055646482,
            0.0851063829787234,
            0.0867430441898527,
            0.0867430441898527,
            0.09001636661211129,
            0.09328968903436989,
            0.09328968903436989,
            0.09983633387888707,
            0.10147299509001637,
            0.11129296235679215,
            0.11783960720130933,
            0.12111292962356793,
            0.12438625204582651,
            0.12929623567921442,
            0.1309328968903437,
            0.1407528641571195,
            0.14402618657937807,
            0.15057283142389524,
            0.15384615384615385,
            0.16202945990180032,
            0.1783960720130933,
            0.21112929623567922,
            0.24877250409165302,
            1.0],
          "tpr": [
            0.0,
            0.05128205128205128,
            0.10256410256410256,
            0.10256410256410256,
            0.28205128205128205,
            0.28205128205128205,
            0.3076923076923077,
            0.3076923076923077,
            0.3333333333333333,
            0.3333333333333333,
            0.5641025641025641,
            0.5641025641025641,
            0.6153846153846154,
            0.6153846153846154,
            0.6410256410256411,
            0.6410256410256411,
            0.6666666666666666,
            0.6666666666666666,
            0.6666666666666666,
            0.6666666666666666,
            0.6923076923076923,
            0.6923076923076923,
            0.6923076923076923,
            0.717948717948718,
            0.717948717948718,
            0.7435897435897436,
            0.7435897435897436,
            0.7692307692307693,
            0.7692307692307693,
            0.7692307692307693,
            0.7692307692307693,
            0.7692307692307693,
            0.7692307692307693,
            0.7692307692307693,
            0.7948717948717948,
            0.8205128205128205,
            0.8205128205128205,
            0.8205128205128205,
            0.8461538461538461,
            0.8974358974358975,
            1.0],
          "auc": 0.8617860590037348,
        },
        "fibrosis": {
          "fpr": [
            0.0,
            0.0,
            0.0,
            0.0033500837520938024,
            0.0033500837520938024,
            0.005025125628140704,
            0.005025125628140704,
            0.006700167504187605,
            0.006700167504187605,
            0.008375209380234505,
            0.008375209380234505,
            0.011725293132328308,
            0.011725293132328308,
            0.01340033500837521,
            0.01340033500837521,
            0.01507537688442211,
            0.01507537688442211,
            0.01675041876046901,
            0.01675041876046901,
            0.018425460636515914,
            0.018425460636515914,
            0.020100502512562814,
            0.020100502512562814,
            0.021775544388609715,
            0.02680067001675042,
            0.03350083752093802,
            1.0],
          "tpr": [
            0.0,
            0.018867924528301886,
            0.11320754716981132,
            0.11320754716981132,
            0.1320754716981132,
            0.1320754716981132,
            0.24528301886792453,
            0.24528301886792453,
            0.2641509433962264,
            0.2641509433962264,
            0.3018867924528302,
            0.3018867924528302,
            0.33962264150943394,
            0.3584905660377358,
            0.37735849056603776,
            0.37735849056603776,
            0.39622641509433965,
            0.39622641509433965,
            0.4716981132075472,
            0.49056603773584906,
            0.5094339622641509,
            0.5094339622641509,
            0.5660377358490566,
            0.5849056603773585,
            0.6037735849056604,
            0.6226415094339622,
            1.0],
          "auc": 0.7982048607818969,
        },
        "infiltration": {
          "fpr": [
            0.0,
            0.05490848585690516,
            0.05490848585690516,
            0.05823627287853577,
            0.05823627287853577,
            0.059900166389351084,
            0.059900166389351084,
            0.06655574043261231,
            0.06988352745424292,
            0.06988352745424292,
            0.07154742096505824,
            0.07154742096505824,
            0.07487520798668885,
            0.07653910149750416,
            0.07986688851913477,
            0.08319467554076539,
            0.08985024958402663,
            0.09317803660565724,
            0.09816971713810316,
            0.10149750415973377,
            0.10316139767054909,
            0.11480865224625623,
            0.13976705490848584,
            1.0],
          "tpr": [
            0.0,
            0.061224489795918366,
            0.1836734693877551,
            0.1836734693877551,
            0.30612244897959184,
            0.30612244897959184,
            0.3673469387755102,
            0.3673469387755102,
            0.3877551020408163,
            0.40816326530612246,
            0.40816326530612246,
            0.42857142857142855,
            0.42857142857142855,
            0.42857142857142855,
            0.42857142857142855,
            0.4489795918367347,
            0.4489795918367347,
            0.4489795918367347,
            0.46938775510204084,
            0.46938775510204084,
            0.5102040816326531,
            0.5510204081632653,
            0.6122448979591837,
            1.0],
          "auc": 0.7355088458012157,
        },
        "mass": {
          "fpr": [
            0.0,
            0.054455445544554455,
            0.056105610561056105,
            0.056105610561056105,
            0.057755775577557754,
            0.057755775577557754,
            0.06105610561056106,
            0.06435643564356436,
            0.07590759075907591,
            1.0],
          "tpr": [
            0.0,
            0.06818181818181818,
            0.06818181818181818,
            0.09090909090909091,
            0.09090909090909091,
            0.11363636363636363,
            0.11363636363636363,
            0.11363636363636363,
            0.11363636363636363,
            1.0],
          "auc": 0.5187331233123311,
        },
        "no_finding": {
          "fpr": [
            0.0,
            0.0587248322147651,
            0.0587248322147651,
            0.06375838926174497,
            0.06375838926174497,
            0.06543624161073826,
            0.06543624161073826,
            0.06879194630872483,
            0.07214765100671142,
            0.07214765100671142,
            0.0738255033557047,
            0.0738255033557047,
            0.07718120805369127,
            0.07718120805369127,
            0.07885906040268456,
            0.07885906040268456,
            0.07885906040268456,
            0.08053691275167785,
            0.08221476510067115,
            0.08557046979865772,
            0.087248322147651,
            0.08892617449664429,
            0.09228187919463088,
            0.09395973154362416,
            0.09899328859060402,
            0.10067114093959731,
            0.1040268456375839,
            0.1040268456375839,
            0.10570469798657718,
            0.10738255033557047,
            0.11073825503355705,
            0.14093959731543623,
            1.0],
          "tpr": [
            0.0,
            0.018518518518518517,
            0.05555555555555555,
            0.05555555555555555,
            0.12962962962962962,
            0.12962962962962962,
            0.14814814814814814,
            0.14814814814814814,
            0.14814814814814814,
            0.18518518518518517,
            0.18518518518518517,
            0.2037037037037037,
            0.2037037037037037,
            0.2222222222222222,
            0.24074074074074073,
            0.2777777777777778,
            0.2962962962962963,
            0.2962962962962963,
            0.3148148148148148,
            0.3148148148148148,
            0.3333333333333333,
            0.3333333333333333,
            0.3333333333333333,
            0.3333333333333333,
            0.35185185185185186,
            0.35185185185185186,
            0.3888888888888889,
            0.42592592592592593,
            0.4444444444444444,
            0.4444444444444444,
            0.5,
            0.5925925925925926,
            1.0],
          "auc": 0.7154486701466567,
        },
        "nodule": {
          "fpr": [
            0.0,
            0.059800664451827246,
            0.059800664451827246,
            0.061461794019933555,
            0.061461794019933555,
            0.06312292358803986,
            0.06312292358803986,
            0.06478405315614617,
            0.06478405315614617,
            0.06976744186046512,
            0.06976744186046512,
            0.07308970099667775,
            0.07308970099667775,
            0.07475083056478406,
            0.07475083056478406,
            0.07807308970099668,
            0.07807308970099668,
            0.08471760797342193,
            0.08471760797342193,
            0.08803986710963455,
            0.08803986710963455,
            0.08803986710963455,
            0.08970099667774087,
            0.08970099667774087,
            0.09302325581395349,
            0.09302325581395349,
            0.09966777408637874,
            0.10132890365448505,
            0.1079734219269103,
            0.10963455149501661,
            0.11129568106312292,
            0.11461794019933555,
            0.12458471760797342,
            0.12624584717607973,
            0.12790697674418605,
            0.12956810631229235,
            0.1345514950166113,
            0.1378737541528239,
            0.14451827242524917,
            0.1478405315614618,
            0.14950166112956811,
            0.14950166112956811,
            0.15282392026578073,
            0.15448504983388706,
            0.1744186046511628,
            0.1744186046511628,
            0.18438538205980065,
            0.19933554817275748,
            0.21760797342192692,
            0.24584717607973422,
            0.292358803986711,
            1.0],
          "tpr": [
            0.0,
            0.0,
            0.10416666666666667,
            0.10416666666666667,
            0.14583333333333334,
            0.14583333333333334,
            0.22916666666666666,
            0.22916666666666666,
            0.2708333333333333,
            0.2708333333333333,
            0.2916666666666667,
            0.2916666666666667,
            0.3333333333333333,
            0.3333333333333333,
            0.4583333333333333,
            0.4583333333333333,
            0.5625,
            0.5625,
            0.6041666666666666,
            0.6041666666666666,
            0.625,
            0.6666666666666666,
            0.6875,
            0.7083333333333334,
            0.7083333333333334,
            0.75,
            0.75,
            0.75,
            0.75,
            0.75,
            0.7708333333333334,
            0.7708333333333334,
            0.7708333333333334,
            0.7708333333333334,
            0.7916666666666666,
            0.7916666666666666,
            0.7916666666666666,
            0.7916666666666666,
            0.7916666666666666,
            0.7916666666666666,
            0.7916666666666666,
            0.8125,
            0.8125,
            0.8125,
            0.8125,
            0.8333333333333334,
            0.8541666666666666,
            0.875,
            0.8958333333333334,
            0.8958333333333334,
            0.8958333333333334,
            1.0],
          "auc": 0.8535610465116279,
        },
        "pleural_thickening": {
          "fpr": [
            0.0,
            0.053833605220228384,
            0.05546492659053834,
            0.05546492659053834,
            0.057096247960848286,
            0.057096247960848286,
            0.05872756933115824,
            0.05872756933115824,
            0.06199021207177814,
            0.06688417618270799,
            0.09135399673735727,
            1.0],
          "tpr": [
            0.0,
            0.08108108108108109,
            0.08108108108108109,
            0.1891891891891892,
            0.1891891891891892,
            0.21621621621621623,
            0.24324324324324326,
            0.2972972972972973,
            0.2972972972972973,
            0.32432432432432434,
            0.40540540540540543,
            1.0],
          "auc": 0.6529253560248667,
        },
        "pneumothorax": {
          "fpr": [
            0.0,
            0.057432432432432436,
            0.05912162162162162,
            0.05912162162162162,
            0.060810810810810814,
            0.060810810810810814,
            0.0625,
            0.0625,
            0.06418918918918919,
            0.06418918918918919,
            0.06756756756756757,
            0.06756756756756757,
            0.06925675675675676,
            0.06925675675675676,
            0.07263513513513513,
            0.07263513513513513,
            0.07432432432432433,
            0.07432432432432433,
            0.07601351351351351,
            0.07939189189189189,
            0.08445945945945946,
            0.09121621621621621,
            0.10135135135135136,
            0.11824324324324324,
            1.0],
          "tpr": [
            0.0,
            0.034482758620689655,
            0.034482758620689655,
            0.05172413793103448,
            0.05172413793103448,
            0.10344827586206896,
            0.10344827586206896,
            0.27586206896551724,
            0.27586206896551724,
            0.3103448275862069,
            0.3103448275862069,
            0.3275862068965517,
            0.3275862068965517,
            0.3448275862068966,
            0.3793103448275862,
            0.41379310344827586,
            0.41379310344827586,
            0.46551724137931033,
            0.4827586206896552,
            0.4827586206896552,
            0.5,
            0.5689655172413793,
            0.603448275862069,
            0.6379310344827587,
            1.0],
          "auc": 0.752388164026095,
        },
      }
      const data = { "data": response }
      res(data)
    }, 500)
  })
}

async function analyzeRandom(image) {
  return new Promise((res, rej) => {
    setTimeout(() => {
      const response = {
        "finding": Math.random() >= 0.5,
        "labels": [
          { label: "atelectasis", probability: Math.random() },
          { label: "cardiomegaly", probability: Math.random() },
          { label: "consolidation", probability: Math.random() },
          { label: "edema", probability: Math.random() },
          { label: "effusion", probability: Math.random() },
          { label: "emphysema", probability: Math.random() },
          { label: "fibrosis", probability: Math.random() },
          { label: "hernia", probability: Math.random() },
          { label: "infiltration", probability: Math.random() },
          { label: "mass", probability: Math.random() },
          { label: "nodule", probability: Math.random() },
          { label: "pleural_thickening", probability: Math.random() },
          { label: "pneumonia", probability: Math.random() },
          { label: "pneumothorax", probability: Math.random() },
        ],
      }
      const data = { "data": response }
      res(data)
    }, 500)
  })
}

async function analyzeGradient(image) {
  return new Promise((res, rej) => {
    setTimeout(() => {
      const response = {
        "finding": Math.random() >= 0.5,
        "labels": [
          { label: "atelectasis", probability: 1 },
          { label: "cardiomegaly", probability: 0.97 },
          { label: "consolidation", probability: 0.92 },
          { label: "edema", probability: 0.87 },
          { label: "effusion", probability: 0.82 },
          { label: "emphysema", probability: 0.77 },
          { label: "fibrosis", probability: 0.72 },
          { label: "hernia", probability: 0.67 },
          { label: "infiltration", probability: 0.62 },
          { label: "mass", probability: 0.57 },
          { label: "nodule", probability: 0.52 },
          { label: "pleural_thickening", probability: 0.47 },
          { label: "pneumonia", probability: 0.37 },
          { label: "pneumothorax", probability: 0.27 },
        ],
      }
      const data = { "data": response }
      res(data)
    }, 500)
  })
}

async function analyzeActual(image) {
  const request = new FormData()
  request.append("image", image, image.fileName)
  return await Axios.post("http://localhost:5000", request)
}
